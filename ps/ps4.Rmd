---
title: "ps4"
author: "whomsoever"
---
---
title: "ps4"
author: "whomsoever"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(gapminder)
library(ggfortify)
library(fivethirtyeight)
```

\ 

# Estimator Bias 

```{r}
## generate a random sample
n = 15
data = sample(1:6, n, replace = TRUE)
```

\ 

```{r}
## a function that calculates sample variance
## but using n in the denominator instead of n-1 (population formula)
varn = function(x) mean((x - mean(x))^2)
```

\ 

```{r}
## two estimates of variance

# use the R function (uses the n-1 denominator)
var(data)

# use the population formula  
varn(data)
```

\ 

```{r}
## repeat the experiment and find the expected value of each estimator

# sample formula
mean(replicate(10000, var(sample(1:6, n, replace = TRUE))))

# population formula 
mean(replicate(10000, varn(sample(1:6, n, replace = TRUE))))
```

\ 

```{r}
## repeat the experiment and find the standard deviation value of each estimator

# sample formula
sd(replicate(10000, var(sample(1:6, n, replace = TRUE))))

# population formula 
sd(replicate(10000, varn(sample(1:6, n, replace = TRUE))))
```



\ 

# Confounding 






\ 

# Predicting Life Expectancy 

We will use data from the most recent year:

```{r}
gm2007 <- gapminder %>% filter(year == "2007")
```


### Fit a linear model predicting life expectancy from GDP per capita

```{r}
reg1 <- lm(lifeExp ~ gdpPercap, data = gm2007)
```

### Summary of the model

```{r}
summary(reg1)
```


### Diagnostic plots

Use the `autoplot()` function to show diagnostics below.

```{r}
autoplot(reg1)
```

\ 

Is there a pattern in the residuals? Do the residuals seem approximately normally distributed?

```
certainly looks like a pattern; not exactly normally distributed; suggests heteroscedastic errors
```

### Transforming to log(GDP per capita)

- Fit a model with `log10(gdpPercap)` as the predictor variable instead of `gdpPercap`
- Compute its summary, compare the value of R-squared to the one for the previous model


```{r}
reg2 <- lm(lifeExp ~ log10(gdpPercap), data = gm2007)

summary(reg2)
```

\ 

Does the model (1) with `gdpPercap` or model (2) with `log10(gdpPercap)` do better at explaining the variance in life expectancy?

```
yes
```

The coefficient for `log10(gdpPercap)` shows the increase in predicted life expectancy if gdpPercap increases by...

```
life exp increases by 16.6 if log10 gdp increases by 1
```

- Show diagnostic plots for this model.

```{r}
autoplot(reg2)
```

\ 
 
Do the residuals have any more or less of an obvious pattern in them? Do they seem any more or less normally distributed?

```
yes, less of an obvious pattern; more normally distributed but still not fully 
```






